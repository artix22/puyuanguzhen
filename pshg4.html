<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>濮商会馆元朝决策</title>
	<style type="text/css">
	
			html,body{
						
						width:100%;
						margin:0px;
						padding: 0px;
					}
						
			body{
					display:flex;
					flex-direction:column;
				}
					
			.container{
						min-width:640px;
						position: relative;
						height:100vh;
						margin:0 auto;
						text-align:center;
						overflow:hidden;
					}
			#overlay {
			    position: absolute;
			    top: 0;
			    left: 0;
			    width: 100%;
			    height: 100%;
			    background: rgba(0, 0, 0, 0); /* 轻微透明 */
			    z-index: 9997; /* 确保它位于其他内容之上 */
			    display: none;
				 cursor: pointer;/* 初始时隐藏，将通过JavaScript显示 */
			}
			#overlay2 {
			    position: absolute;
			    top: 0;
			    left: 0;
			    width: 100%;
			    height: 100%;
			    background: rgba(0, 0, 0, 0); /* 轻微透明 */
			    z-index: 9998; /* 确保它位于其他内容之上 */
			    display: none;
				 cursor: pointer;/* 初始时隐藏，将通过JavaScript显示 */
			}
			.block-link{
				position:absolute;
				width:100%;
				height:100%;
				left:0;
				top:0;
			}
			 /* 隐藏除第一阶段外的所有阶段 */
			        .stage {
			            display: none;
			        }
			 
			        /* 显示当前阶段的样式（通过JavaScript动态添加） */
			        .active-stage {
			            display: block;
						width:100%;
						height:100%;
						top:0;
						left:0;
						position:absolute;
			        }
			#bg{
						position:relative;
						margin:auto;
						width:fit-content;
						overflow: hidden;
					}
			
			#back{
				    position: absolute;
					width: 10%;
					right: 86.9%;
					top: 2.5%;
					z-index: 9999;
					cursor: pointer;
				}
			
			.bgimg{
					width:100%;
					height:100%;
					height:100vh;
					}
			
			#jc{
				max-width: 100%; /* Ensure images scale with the container */
				height: auto;
				 width:70%;
				 margin-top: 0;
			}
			.typing-effect {
				display: inline-block; /* 行内块级元素 */
				opacity: 0; /* 初始透明度 */
				animation: fadeIn 0.1s forwards; /* 动画效果 */
			}
						 
			@keyframes fadeIn {
				to {
					opacity: 1;
				}
			}
			#dh2{
				width:100%;
				height:100%;
				position:absolute;
				z-index:10;
				left:0;
				top:0;
			}
			#js21{
				position:absolute;
				width:56%;
				height:20%;
				left:24%;
				top:10%;
				text-align: left;
				z-index:11;
			}
			#js22{
				position:absolute;
				width:56%;
				height:20%;
				left:24%;
				top:30%;
				text-align:left;
				z-index:11;
			}
			#js23{
				position:absolute;
				width:56%;
				height:20%;
				left:24%;
				top:50%;
				text-align: left;
				z-index:11;
			}
			#js2-text1,#js2-text2,#js2-text3 {
						color: #ad7600;
						font-weight: bold;
						white-space: normal; /* 保持空白字符和换行符 */
						width:100%;
						 height:100%;/* 隐藏超出容器的文字 */
						display: inline-block; /* 允许设置宽度和高度 */
						vertical-align: top;
						/* 垂直对齐 */
					}
			#d{
				display: flex;
				
				position:absolute;
				top:14%;
				transform: translate(0%,-50%);
				align-items: center;
				justify-content: center;
				text-align: center;
				width: 100%;
				max-width: 600px; /* Limit maximum width for better readability on large screens */
				margin: auto;
				
							
							
				box-sizing: border-box;
			}
			#jd{
				position:absolute;
				width:56%;
				height:60%;
				left:24%;
				bottom: 20%;
				text-align: left;
			}
			#jd-text {
						color: #ad7600;
						font-weight: bold;
						white-space: normal; /* 保持空白字符和换行符 */
						width:100%;
						 height:65%;/* 隐藏超出容器的文字 */
						display: inline-block; /* 允许设置宽度和高度 */
						vertical-align: top;
						line-height: 1.6;
						/* 垂直对齐 */
					}
			#ty{
				position:absolute;
				width:25%;
				left:3%;
				margin:5%;
				bottom:0;
				display:block;
				z-index:11;
				cursor: pointer;
			}
			#jj{
				position:absolute;
				width:26%;
				left:56%;
				margin:5%;
				bottom:0;
				display:block;
				z-index:11;
				cursor: pointer;
			}
			#pss{
				position:absolute;
				width:30%;
				left:32%;
				bottom:-30%;
				display:none;
				z-index:11;
				animation:pss 6s linear 1 forwards ;
			}
			@keyframes pss{
				0%,80% {
				    opacity: 0;
				  }
				  
				  100%{
					  opacity: 1;
				  }
			}
			
			.vol1{
					height:2.1%;
					width:1.4%;
					position:absolute;
					top:6.8%; left:40.5%; z-index: 10000; 
					
				}
			.vol2{
					height:1.5%;
					width:1%;
					position:absolute;
					top:27%; left:56.7%; z-index: 10000; 
					
				}
			.vol0{
					height:0;
					width:0;
					position:absolute;
					top:0%; left:0%; z-index: 10000; 
					
				}
			.vol3-1{
					height:2.1%;
					width:1.2%;
					position:absolute;
					top:6.8%; left:40.5%; z-index: 10000; 
					
				}
			.vol3-2{
					height:2.1%;
					width:1.2%;
					position:absolute;
					top:6.8%; left:40.5%; z-index: 10000; 
					
				}
				
			/* 针对移动端设备的调整 */
			@media (max-width: 768px) {
				
				.vol1{
					height:1.8%;
					width:4%;
					position:absolute;
					top:12%; left:19%; z-index: 10000; 
					
				}
				.vol2{
						height:1.8%;
						width:4%;
						position:absolute;
						top:26.5%; left:71.2%; z-index: 10000; 
						
					}
				.vol0{
						height:0;
						width:0;
						position:absolute;
						top:0%; left:0%; z-index: 10000; 
						
					}
				.vol3-1{
						height:1.8%;
						width:4%;
						position:absolute;
						top:8.5%; left:19%; z-index: 10000; 
						
					}
				.vol3-2{
						height:1.8%;
						width:4%;
						position:absolute;
						top:8.5%; left:19%; z-index: 10000; 
						
					}
					
				.container {
					min-width: 100%; 
					background-size: cover; 
				}
				.back, .button {
					
					width: auto; 
					bottom: initial;
					left: initial; 
					
				}
				
				#pss{
					position:absolute;
					width:30%;
					left:57%;
					bottom:-35%;
					display:none;
					z-index:11;
					animation:pss 6s linear 1 forwards ;
				}
				
				#js2-text1 span.typing-effect {
				    line-height: 1.8;
				}
			}
			#js2-text1 span.typing-effect {
			    line-height: 1.6;
			}
		</style>
		<script>
			 document.addEventListener('DOMContentLoaded', function() {
				  let currentStage = 2; // 当前阶段，初始为1
				         const stages = document.querySelectorAll('.stage'); // 获取所有阶段
				         const overlay = document.getElementById('overlay'); // 获取透明图层
			 			
			 			function typeText(textElement, textToDisplay, callback) {
			 			    let textIndex = 0; // 这是一个局部变量，不应该在函数外部定义
			 			    const typingSpeed = 50; // 打字速度，单位毫秒
			 			 
			 			    function innerTypeText() {
			 			        if (textIndex < textToDisplay.length) {
			 			            const newSpan = document.createElement('span');
			 			            newSpan.className = 'typing-effect';
			 			            newSpan.textContent = textToDisplay[textIndex];
			 			            textElement.appendChild(newSpan);
			 			            textIndex++;
									if (textIndex === 1) {
									    audioPlayer1.play();
									}
			 			            setTimeout(innerTypeText, typingSpeed);
			 			        }else {
                                  if (callback && typeof callback === 'function') {
                                          callback();
                                    }
			 			    }
			 			 }
						 // 语音朗读函数
						 let speaking = false;
						 function speakText() {
						     const utterance = new SpeechSynthesisUtterance(textToDisplay);
						     utterance.lang = 'zh-CN'; // 设置语言为中文
						 
						     // 当语音开始时，设置speaking为true
						     utterance.onstart = function () {
						         speaking = true;
						     };
						 
						     // 当语音结束时，设置speaking为false
						     utterance.onend = function () {
						         speaking = false;
						     };
						 
						     // 如果浏览器支持语音合成，则朗读文本
						     if (speechSynthesis) {
						         speechSynthesis.speak(utterance);
						     }
						 }
						 
			 			    innerTypeText();
			 			}
						
						document.getElementById("audioPlayer1").src= "oracle2-1.mp3";
						document.getElementById("vol1").className= "vol2";
			 					            const js2Text1Element = document.getElementById('js2-text1');
			 					            const textForStage21 = "随着牙行的发展，财富与精美的制品数不胜数，但一直在当地发展远不满足我们的需求，于是开启第二次会议，是否对外开放就成了最重要的问题，我们几百年的历史，就是要敢拼敢搏。";
			 					            js2Text1Element.innerHTML = '';
			 					     
			 					            typeText(js2Text1Element, textForStage21, () => {
			 					                const js2Text2Element = document.getElementById('js2-text2');
			 					                const textForStage22 = "不同意";
			 					                js2Text2Element.innerHTML = '';
			 					     
			 					            typeText(js2Text2Element, textForStage22, () => {
			 					                const js2Text3Element = document.getElementById('js2-text3');
			 					                const textForStage23 = "我也支持";
			 					                js2Text3Element.innerHTML = '';
			 					     
			 					            typeText(js2Text3Element, textForStage23);
			 								
			 					       
			 				    });
			 				});		  
			 			
						
						// 显示当前阶段，隐藏其他阶段
						            function showStage(stageNumber) {
						                stages.forEach(stage => {
						                    stage.classList.remove('active-stage'); // 移除所有阶段的active-stage类
						                    if (stage.id === `stage${stageNumber}`) {
						                        stage.classList.add('active-stage'); // 为当前阶段添加active-stage类
						                    }
						                });
										
						                // 根据需要重置或更新当前阶段的JavaScript逻辑（例如打字效果）
						                if (stageNumber === 1) {
						                    
						                }
										if (stageNumber === 2) {
										    // 重置打字效果（如果需要）
										    
										}
										if (stageNumber === 3) {
										   document.getElementById("vol1").className= "vol0";
										   const jdTextElement = document.getElementById('jd-text');
										   const textForStage3 = "现在大家都做出了决定，请你也作出决定，你的一举一动都代表着濮商的发展。";
										   jdTextElement.innerHTML = '';
										   typeText(jdTextElement, textForStage3, function() {
										               // 打字完成后添加事件监听器
										               const tyImg = document.getElementById('ty');
										               tyImg.onclick = function() {
														   document.getElementById("audioPlayer1").src= "oracle2-2-1.mp3";
														   document.getElementById("vol1").className= "vol3-1";
										                   const newText = "会议中多票战胜少票，还是选择了对外开放，随着牙行开始发展，我们拥有了更多的财富，对外发展十分迅速，吸引了许多洋人来购买，让商会达到了发展的顶峰，在发展后，你确定了我们的名字:";
														   
														   jdTextElement.innerHTML = '';
										                   typeText(jdTextElement, newText);
														   document.getElementById("jd").style.bottom="30%";
														   document.getElementById("ty").style.display="none";
														   document.getElementById("jj").style.display="none";
														   document.getElementById("pss").style.display="block";
										               };
													   const jjImg = document.getElementById('jj');
													   jjImg.onclick = function() {
														   document.getElementById("audioPlayer1").src= "oracle2-2-2.mp3";
														   document.getElementById("vol1").className= "vol3-2";
													       const newText2 = "会议中多票战胜了少票，还是选择了对外开放，随着牙行的发展，我们拥有了更多的财富，对外发展十分迅速，吸引了许多洋人来购买，让商会达到了发展的顶峰，在江南下，你确定了我们的名字:";
													       jdTextElement.innerHTML = '';
													       typeText(jdTextElement, newText2);
														   document.getElementById("jd").style.bottom="30%";
													   		document.getElementById("ty").style.display="none";
													   		document.getElementById("jj").style.display="none";
													   		document.getElementById("pss").style.display="block";
													   };
										           });
									
										}
						                // ...（其他阶段的逻辑）...
						            }
						 
						            // 显示透明图层，并监听点击事件以切换到下一个阶段
						            overlay.addEventListener('click', function() {
						                if (currentStage < 3) { // 如果当前阶段不是最后一个阶段
						                    currentStage++; // 切换到下一个阶段
						                    showStage(currentStage); // 显示下一个阶段的内容
						                }
										if (currentStage==3) {
											overlay.style.display="none";
										}
										
						            });
						 
						            // 初始时显示透明图层（如果需要）
						            overlay.style.display = 'block';
			  
			 		
			  
			 			// 调整字体大小的函数（如果需要的话）
			 			function adjustFontSize( ) {
			 				const container = document.getElementById('bg');
			 				const baseFontSize = 16; // 基础字体大小
			 				const scaleFactor = Math.min(container.clientWidth / 600, container.clientHeight / 200); // 假设 600x300 是设计时的参考尺寸（注意这里我改为了300，因为#c的高度看起来像是与这个值相关）
				 			const newFontSize = `${baseFontSize * scaleFactor}px`;
	 				 		const jsElementWrapper = document.querySelector('#c #js'); // 获取#js的父容器或者直接#js（如果#js本身需要调整大小）
				 			const jsTextElement = document.getElementById('js-text');
						 		if (jsTextElement) {
			 					    jsTextElement.style.fontSize = newFontSize;
			 					    // 由于打字效果是基于span元素的，并且这些span可能没有继承jsTextElement的字体大小，
			 				        // 你可以选择直接设置这些span的字体大小，或者确保CSS规则允许它们继承。
			 					    // 在这里，我们假设CSS已经处理好了这个问题。
						 	    }
			 							 				 
			 					    // 调整stage2文本元素的字体大小
			 					const stage2TextElements = [document.getElementById('js2-text1'), document.getElementById('js2-text2'), document.getElementById('js2-text3')];
			 					stage2TextElements.forEach(element => {
						 			if (element) {
 							 	        element.style.fontSize = newFontSize;
			 					        // 同样地，确保span.typing-effect继承了这些元素的字体大小，或者直接设置它们的大小。
			 			 		    }
						 	    });
								const jdTextElement = document.getElementById('jd-text');
								jdTextElement.style.fontSize = newFontSize;
			 					}
										  
							window.addEventListener('resize', adjustFontSize);
							window.addEventListener('load', adjustFontSize);
							
							var pssElement = document.getElementById('pss');
							var overlay2Element = document.getElementById('overlay2');
											 
							pssElement.addEventListener('animationend', function() {
							    // 检查是否是 'yh' 动画结束
							    if (event.animationName === 'pss') {
							        overlay2Element.style.display = 'block';
							    }
							});
						
			 		});
					
					var volnum=1;
					
					function change(){  
					    $("#start").attr("src", "src26_1.png");
					}  
					function reset(){
					    $("#start").attr("src", "src26.png");
					} 
					
					function changevol1() {
					    var volImg = document.getElementById("vol1");
					    if (volnum == 1) {
					        volImg.src = "voloff.jpg"; 
							audioPlayer1.pause();
					        volnum = 0; 
					    } else {
					        volImg.src = "volon.jpg";
							audioPlayer1.play();
					        volnum = 1;
					    }
					
					}
					
		</script>
	</head>
	<body>
		
		<img id="vol1" src="volon.jpg" class="vol1" style="position:absolute;" alt='声音' onclick="changevol1()">
		<audio id="audioPlayer1" src="oracle2-1.mp3" preload="auto"></audio>
		<div class="container">	
		    <div id="bg">
			    <img class="bgimg" src="psbg4.png"/>
				
			    <a href="pushangwenhua1_1.html">
					<<img id="back" src="psback.png" alt="返回键"/>
				</a>
				
				<div id="stage2" class="stage active-stage">
				    
						<img id="dh2" src="dh2.png"/>
						<div id="js21" style="position:absolute;width:40%;height:15%;left:38%;top:11%;">
							<span id="js2-text1"></span>
						</div>
						<div id="js22" style="position:absolute;width:11%;height:3%;left:40%;top:44%;">
							<span id="js2-text2"></span>
						</div>
						<div id="js23" style="position:absolute;width:14%;height:3%;left:9%;top:46%;">
							<span id="js2-text3"></span>
						</div>
					           <!-- 阶段2的内容 -->
				</div>
				<div id="stage3" class="stage hidden">
				    <div id="d">
				        <img id="jc" src="juece.png"/>
				        <div id="jd">
				    		<span id="jd-text"></span>
							 <img id="ty" src="ty.png" />
							 <img id="jj" src="jj.png" />
							 <img id="pss" src="pss.png" />
							 <!-- 这里是显示打字效果的容器 -->
				        </div>
				    </div>            <!-- 阶段3的内容 -->
				</div>
				<div id="overlay" class="hidden"></div>
				<div id="overlay2" class="hidden">
					<a href="pshg5.html" class="block-link"></a>
				</div>
			</div>
		</div>
		
	
	</body>
	</html>